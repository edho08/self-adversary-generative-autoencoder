
# Self Adversary Generative Autoencoder

In this project we explore an implementation of Energy Based GAN and Boundary Equilibrium GAN with shared weight.
The network architecture used in this project is an autoencoder used to approximate the energy function of the data in which real data should be assigned to low energy.
We then take the decoder of the autoencoder to also train it as a generator in a GAN setting.
The idea of the project is that the training process should bring the distribution of latent representation of the autoencoder to a given distribution. e.g. uniform or normal distribution.




## Network Architecture

As have stated before, the network architecture used in this project is an autoencoder.
The autoencoder is trained to reconstruct the data in the dataset. 
This training is done so the network can assign low energy to the correct data.
The whole autoencoder will now be considered as the discriminator in the GAN training setting.
The decoder part of the auto encoder is then trained to generate fake sample with an input latent vector from a known distribution.
This decoder part will be known as the generator in GAN training setting. 
The training is done on the base of BE-GAN training. However here the generator and discriminator share the same weight.

![alt text](https://github.com/edho08/self-adversary-generative-autoencoder/blob/master/diagram.png?raw=true)

## Result
Using MNIST dataset, the model can generate fake samples resambling that of real sample. 
The resulting generated image is also quite good.
Although with no contrastive sampling like those proposed on BEGAN, the model suffer from mode collapse. 
Below is the image generated by the model after 4 epoch of trainig. More of these figure can be found on "fig_train" directory of the project.
![alt text](https://github.com/edho08/self-adversary-generative-autoencoder/blob/master/fig_train/4_6000.png?raw=true)
The use of contrastive sampling alleviate this problem but it resulted in low quality of generated image. Below is an example of generated image after training with contrastive sampling. More of these figure can be found on "fig_with_feedback" directory.
![alt text](https://github.com/edho08/self-adversary-generative-autoencoder/blob/master/fig_with_feedback/3_5000.png?raw=true)
In comparison, below is a generated image when the network is only trained as an autoencoder and not trained in GAN manner. The generated image doesnt match with the original image distribution.
![alt text](https://github.com/edho08/self-adversary-generative-autoencoder/blob/master/fig_no_train/2_9000.png?raw=true)

## Result
Using MNIST dataset, the model can generate fake samples resambling that of real sample. 
The resulting generated image is also quite good.
Although with no contrastive sampling like those proposed on BEGAN, the model suffer from mode collapse. 
Below is the image generated by the model after 4 epoch of trainig. More of these figure can be found on "fig_train" directory of the project.
![alt text](https://github.com/edho08/self-adversary-generative-autoencoder/blob/master/fig_train/4_6000.png?raw=true)
The use of contrastive sampling alleviate this problem but it resulted in low quality of generated image. Below is an example of generated image after training with contrastive sampling. More of these figure can be found on "fig_with_feedback" directory.
![alt text](https://github.com/edho08/self-adversary-generative-autoencoder/blob/master/fig_with_feedback/3_5000.png?raw=true)
In comparison, below is a generated image when the network is only trained as an autoencoder and not trained in GAN manner. The generated image doesnt match with the original image distribution.
![alt text](https://github.com/edho08/self-adversary-generative-autoencoder/blob/master/fig_no_train/2_9000.png?raw=true)

## Future Work
This network architecture might also can be used to do style transfer albeit might not be as good as other model as have been shown before on training with contrastive sampling.
![alt text](https://github.com/edho08/self-adversary-generative-autoencoder/blob/master/diagram%20style.png?raw=true)
